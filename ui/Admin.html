<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>AdminFlightPage</title>
  <!-- bootstrap v5 cdn: -->
  

</head>

<body>
  <div>
    <h1>Schedule A New Flight</h1>
    <form id="addFlight">
      <label for="origin">Origin City: </label><br />
      <input type="text" name="origin" id="originCity" required /><br />

      <label for="destination">Destination: </label><br />
      <input type="text" name="destination" id="destination" required /><br />

      <label for="start_time">Start Date: </label><br />
      <input type="date" name="start_time" id="start_time" required /><br />

      <label for="end_time">End Date: </label><br />
      <input type="date" name="end_time" id="end_time" required /><br />

      <button type="submit">Submit</button><br /><br />
      <button type="reset">Reset</button>
    </form>
  </div>

  <div>
    <h1>Cancel A Flight</h1>
    <form id="cancelFlight">
      <label for="flightNumber">Flight Number: </label><br />
      <input type="number" id="flightNumber" required /><br /><br />
      <button type="submit">Cancel Flight</button><br /><br />
      <button type="reset">Reset</button>
    </form>
  </div>

  <script>
    const form = document.getElementById("addFlight");

    form.addEventListener("submit", function (event) {
      event.preventDefault();
      submitForm(
        originCity.value,
        destination.value,
        start_time.value,
        end_time.value,
      );
    });

    async function submitForm(
      originCityValue,
      destinationValue,
      sTimeValue,
      eTimeValue,
    ) {
      let formObject = {
        origin: originCityValue,
        destination: destinationValue,
        begin: sTimeValue,
        end: eTimeValue,
      };
      console.log(formObject);

      let response = await fetch("http://localhost:8080/Project-1/flights", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Method": "addFlight"
        },
        body: JSON.stringify(formObject),
      });
    }

    async function getActivePassengers() {
      let resp = await fetch(
        "http://localhost:8080/Project-1/active-passengers"
      );
      let json = await resp.jason();
      let table = document.getElementById("activePassengersTable");

      for (let element of json) {
        let tr = table.insertRow(-1);
        for (let key in elements) {
          let cell = tr.insertCell(-1);
          cell.innerHTML = element[key];
        }
      }
    }
    async function getAllFlights() {
      let resp = await fetch(
        "http://localhost:8080/Project-1/active-Flights"
      );
      let json = await resp.jason();
      let table = document.getElementById("activeFlightsTable");
      for (let element of json) {
        let tr = table.insertRow(-1);
        for (let key in elements) {
          let cell = tr.insertCell(-1);
          cell.innerHTML = element[key];
        }
      }
    }

    const cancelForm = document.getElementById("cancelFlight");

    cancelForm.addEventListener("submit", function (event) {
      event.preventDefault();
      cancelForm2(

        flightNumber.value
      );
    });


    async function cancelForm2() {

      let formObject = {
        flightNumber: flightNumber.value,
      };
      console.log("cancel form reached");
      let resp = await fetch("http://localhost:8080/Project-1/flights", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Method": "cancelFlight"
        },
        body: JSON.stringify(formObject),
      });
    }
  </script>

  <div>
    <h1>Active Flight(s)</h1>
    <table>
      <thead>
        <tr>
          <th>Active Passengers:</th>
        </tr>
      </thead>
      <tbody id="activePassengersTable"></tbody>
    </table>
    <table>
      <thead>
        <tr>
          <th>Current Active Flight:</th>
          <th>Start Date/Time:</th>
          <th>End Date/Time:</th>
        </tr>
      </thead>
      <tbody id="activeFlightsTable"></tbody>
    </table>
  </div>
 

</body>

</html>